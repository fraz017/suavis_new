<video autoplay id="video"></video>
<select id="cameras">


</select>
<script>
    var deviceId;
    var videoDevices = [0,0];
var videoDeviceIndex = 0;
    navigator.mediaDevices.enumerateDevices()
   .then((devices) => {
       devices.find((device) => {   
        if (device.kind === 'videoinput') {
            videoDevices[videoDeviceIndex++] =  device.deviceId;
            var videoDeviceElement = document.getElementById("cameras")
                console.log("here", videoDeviceElement)
               const option = document.createElement('option');
               option.text = device.label || 'camera '+ (videoDeviceElement.length + 1).toString();
               option.value = device.deviceId;
               // Store the camera ID in the select element to switch between the front-facing and rear-facing cameras
               videoDeviceElement.appendChild(option);
           }
       });

       if (videoDeviceElement.length === 0) {
           reject('no camera');
       } else {
           resolve(true);
       }
   })
   .catch((err) => {
   });

   const constraints =  {width: { min: 1024, ideal: 1280, max: 1920 },
                height: { min: 776, ideal: 720, max: 1080 },
                deviceId: { exact: videoDevices[1]},
                audio: false,
                video: {deviceId: {exact: videoDevices[1]}}  
            };

    navigator.mediaDevices.getUserMedia(constraints)
        .then((stream) => {
            console.log(stream)
            // The variable "videoElement" is the video element, and it would bind camera stream to video for preview in real time
            var videoElement = document.getElementById("video")
            videoElement.srcObject = stream;
            videoElement.style.display = 'block';
            videoElement.play();
            resolve(true);
        })
        .catch((err) => {
            
        });

        canvasContext.drawImage(videoElement, 0, 0, videoSetting.width, videoSetting.height);
const image = canvasElement.toDataURL('image/jpeg', 0.5).split('base64,')[1];
</script>